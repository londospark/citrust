# Orchestration: Fox (GUI Dev)
**Timestamp:** 2026-02-22T014202Z  
**Task:** egui GUI + gamepad support (#18, #19)  
**Outcome:** SUCCESS

## Summary
Fox implemented full egui/eframe GUI with 3-screen workflow and gamepad-friendly design targeting SteamOS.

## Deliverables
- **src/gui.rs** (270+ LOC) — Complete egui GUI application
- **Cargo.toml** modifications:
  - Added `gui` optional feature
  - Optional dependencies: eframe, egui, rfd, winit
  - New binary target: `citrust-gui`
- **Both builds compile successfully:**
  - `cargo build` → CLI-only (1.6 MB)
  - `cargo build --features gui --bin citrust-gui` → GUI (9.2 MB)

## UI Design
- **Framework:** egui + eframe (immediate-mode, lightweight, Linux/Wayland native)
- **Theme:** Dark (SteamOS aesthetic)
- **Font sizes:** 48px heading, 28px buttons, 24px body
- **Button hit targets:** 400x80px minimum (gamepad-friendly)
- **Window size:** 1280x800 (Steam Deck native resolution)
- **Navigation:** Full keyboard support (Tab/Enter) for gamepad mapping via Steam Input

## Screen Workflow
1. **Select File:** ROM picker with rfd file dialog, "Decrypt" button
2. **Decrypting:** Real-time progress with:
   - Encryption method detected
   - Section tracker (ExHeader → ExeFS → RomFS)
   - Per-section MB counters
   - Elapsed time
   - Scrollable message log
3. **Done:** Success message, "Decrypt Another" and "Quit" buttons

## Architecture
- **File picker:** rfd with XDG Desktop Portal backend (native Linux dialogs)
- **Threading:** Background thread runs decrypt_rom(), UI polls mpsc::channel each frame
- **Borrow checker pattern:** Collect state changes in locals, apply after releasing mutable borrow
- **Gamepad support:** Steam Input keyboard mapping (Tab/Enter); direct gilrs noted for future enhancement

## Testing
- ✅ CLI build unaffected (still 1.6 MB, fully functional)
- ✅ GUI builds with `--features gui`
- ✅ Both binaries compile successfully
- ⚠️ Manual UX testing pending (requires real ROM + hardware/SteamOS)

## Next Steps
1. **Phase 4 integration:** Workspace split (Samus #17) → citrust-core, citrust-cli, citrust-gui crates
2. **UX validation:** Manual testing with real ROM on Linux/SteamOS
3. **Enhancement:** Add gilrs direct gamepad input (Issue #19 enhancement)
4. **Packaging:** AppImage for SteamOS (Samus #20)
